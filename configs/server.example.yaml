# xPenetration 服务端配置文件

server:
  # 监听地址
  listen_addr: "0.0.0.0"
  # 控制端口（客户端连接此端口，TCP）
  control_port: 7000
  # UDP数据传输端口（用于原生UDP隧道，客户端与服务端之间的UDP传输）
  udp_port: 7001
  # Web管理界面端口
  web_port: 7500
  # 传输加密开关（对TCP与UDP隧道数据加密）
  encryption:
    enabled: true
  # 全局密钥（客户端验证用）
  secret_key: "your-secret-key-change-me"
  # Web管理界面认证（Basic Auth，可选）
  # 如果配置了用户名和密码，访问管理界面时需要认证
  # 留空或删除此项则不启用认证
  # web_auth:
  #   username: "admin"
  #   password: "your-password"

# 客户端配置列表
# 每个客户端可以配置专属密钥和分配的隧道
clients:
  # 客户端1：SSH服务穿透（本机）
  - name: "office-pc"
    # 客户端专属密钥（可选，为空则使用全局密钥）
    secret_key: ""
    # 分配给该客户端的隧道
    tunnels:
      - name: "ssh"
        client_port: 22      # 客户端本地SSH端口
        server_port: 10022   # 服务端暴露端口
        protocol: "tcp"
        # target_ip: "127.0.0.1"  # 可选：目标IP，默认为127.0.0.1（本机）
      - name: "rdp"
        client_port: 3389    # 客户端本地RDP端口
        server_port: 13389   # 服务端暴露端口
        protocol: "tcp"
      # 穿透同一局域网内其他设备的示例
      - name: "nas-ssh"
        client_port: 22      # NAS设备的SSH端口
        server_port: 20022   # 服务端暴露端口
        protocol: "tcp"
        target_ip: "192.168.1.100"  # 局域网内NAS设备的IP地址
      - name: "router-web"
        client_port: 80      # 路由器Web管理端口
        server_port: 20080   # 服务端暴露端口
        protocol: "tcp"
        target_ip: "192.168.1.1"    # 局域网内路由器的IP地址

  # 客户端2：Web服务穿透
  - name: "dev-server"
    secret_key: "dev-server-secret-key"
    tunnels:
      - name: "web"
        client_port: 80
        server_port: 10080
        protocol: "tcp"
      - name: "web-https"
        client_port: 443
        server_port: 10443
        protocol: "tcp"
      - name: "dev-api"
        client_port: 8080
        server_port: 18080
        protocol: "tcp"

  # 客户端3：数据库穿透
  - name: "db-server"
    secret_key: "db-server-secret-key"
    tunnels:
      - name: "mysql"
        client_port: 3306
        server_port: 13306
        protocol: "tcp"
      - name: "redis"
        client_port: 6379
        server_port: 16379
        protocol: "tcp"

  # 客户端4：UDP服务穿透示例（包括局域网设备）
  - name: "game-server"
    secret_key: "game-server-secret-key"
    tunnels:
      - name: "game-udp"
        client_port: 27015    # 游戏服务UDP端口
        server_port: 27015    # 服务端暴露UDP端口
        protocol: "udp"       # UDP隧道
        udp_mode: "native"    # UDP传输模式：native（原生UDP，默认）或 tcp（通过TCP封装，备用方法）
      - name: "dns"
        client_port: 53       # DNS服务
        server_port: 10053
        protocol: "udp"
        udp_mode: "native"    # 推荐使用原生UDP模式，延迟更低
      - name: "voip"
        client_port: 5060     # VoIP SIP端口
        server_port: 15060
        protocol: "udp"
        udp_mode: "tcp"       # 可选：使用TCP封装（在某些NAT环境下更稳定，但可能丢包）
      # 穿透局域网内其他设备的UDP服务
      - name: "camera-udp"
        client_port: 8554     # 摄像头RTSP/UDP端口
        server_port: 18554
        protocol: "udp"
        udp_mode: "native"
        target_ip: "192.168.1.50"  # 局域网内摄像头的IP地址

# 日志配置
log:
  # 日志级别: debug, info, warn, error
  level: "info"
  # 输出位置: stdout 或文件路径
  output: "stdout"
